<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <title>Tester un template</title>
    <script src="Totem/jquery.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/beta/hosted/office.js"></script>
    <script>
        Office.initialize = function (reason) {
            $(function () {
                $("input[id='submit']").on("click", function () {
                    var datasource = $("input[id='datasource']")[0].files[0];
                    if (datasource !== null) {
                        var reader = new FileReader();
                        reader.addEventListener('load', function (e) {
                            var xmlString = e.target.result;

                            Office.context.ui.messageParent(xmlString);
                        });
                        reader.readAsText(datasource);
                    }
                });
            });
        };
    </script>
    <style>
        #content {
            width: 100%;
        }

        input#datasource {
            border: 1px solid lightgrey;
        }

        input#submit {
            border: 1px solid lightgrey;
            margin-top: 5px;
        }
    </style>
</head>
<body class="ms-Fabric" dir="ltr">
    <div id="content">
        <input id="datasource" type="file" /><br />
        <input id="submit" type="button" value="Tester" />
    </div>
</body>
</html>
